<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="Check if a website is down" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Is site down?</title>
    <style>
      body {
        max-width: 750px;
        margin: 0 auto;
        text-align: center;
        font-family: system-ui, sans-serif;
        line-height: 1.5;
      }

      input,
      button {
        font-family: inherit;
        font-size: 100%;
        padding: 0.5em 1em;
      }

      form {
        display: flex;
        align-items: center;
        margin: 0 0.5em;
      }

      input#url {
        flex: 1;
        margin: 0 0.5em;
      }
    </style>
  </head>
  <body>
    <h1>Is site down?</h1>
    <form>
      <label for="url">Enter URL:</label>
      <input
        id="url"
        type="url"
        required
        placeholder="e.g., https://example.com/"
      />
      <button>Check</button>
    </form>
    <p id="output"></p>
    <script>
      const input = document.querySelector("input#url");
      const output = document.querySelector("#output");
      document.querySelector("form").onsubmit = (e) => {
        e.preventDefault();
        const url = input.value;
        output.textContent = `Checking ${url} ...`;
        fetch("api/check?url=" + url)
          .then((res) => res.json())
          .then((json) => {
            const { error, isDown, reason } = json;
            if (error) {
              output.textContent = `Error: ${error}`;
            } else if (isDown) {
              output.innerHTML = `<a href=${url}>${url}</a> is down, ${reason}`;
            } else {
              output.innerHTML = `<a href=${url}>${url}</a> is up`;
            }
          })
          .catch((error) => {
            output.textContent = `Error: ${error}`;
          });
      };
    </script>
  </body>
</html>
